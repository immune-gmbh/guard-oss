import classNames from 'classnames';
import * as IssuesV1 from 'generated/issuesv1';
import tailwindConfig from 'tailwind.config';
import { ApiSrv } from 'types/apiSrv';

export const VERDICT_STATUS_STEPS: Record<
  Exclude<keyof ApiSrv.Verdict, 'result' | 'type'>,
  string
> = {
  supply_chain:
    'M6.42857 18.0519C7.25189 18.0518 8.04999 18.3404 8.68779 18.8689C9.32558 19.3975 9.76391 20.1335 9.92857 20.9524H20V6.45022H4.28571C3.52795 6.45022 2.80123 6.7558 2.26541 7.29973C1.72959 7.84367 1.42857 8.58141 1.42857 9.35065V20.9524H2.92857C3.09324 20.1335 3.53156 19.3975 4.16936 18.8689C4.80715 18.3404 5.60525 18.0518 6.42857 18.0519ZM6.42857 25.303C5.60525 25.3032 4.80715 25.0146 4.16936 24.4861C3.53156 23.9575 3.09324 23.2215 2.92857 22.4026H0V9.35065C0 8.19679 0.451529 7.09018 1.25526 6.27428C2.05898 5.45837 3.14907 5 4.28571 5H20C20.3789 5 20.7422 5.15279 21.0102 5.42476C21.2781 5.69673 21.4286 6.0656 21.4286 6.45022V9.35065H25.7143L30 15.124V22.4026H27.0714C26.9075 23.2222 26.4695 23.959 25.8316 24.4883C25.1937 25.0175 24.3953 25.3067 23.5714 25.3067C22.7476 25.3067 21.9491 25.0175 21.3112 24.4883C20.6734 23.959 20.2354 23.2222 20.0714 22.4026H9.92857C9.76391 23.2215 9.32558 23.9575 8.68779 24.4861C8.04999 25.0146 7.25189 25.3032 6.42857 25.303V25.303ZM6.42857 19.5022C5.86025 19.5022 5.31521 19.7314 4.91334 20.1393C4.51148 20.5473 4.28571 21.1006 4.28571 21.6775C4.28571 22.2544 4.51148 22.8077 4.91334 23.2157C5.31521 23.6236 5.86025 23.8528 6.42857 23.8528C6.99689 23.8528 7.54194 23.6236 7.9438 23.2157C8.34566 22.8077 8.57143 22.2544 8.57143 21.6775C8.57143 21.1006 8.34566 20.5473 7.9438 20.1393C7.54194 19.7314 6.99689 19.5022 6.42857 19.5022ZM23.5714 18.0519C24.3948 18.0518 25.1928 18.3404 25.8306 18.8689C26.4684 19.3975 26.9068 20.1335 27.0714 20.9524H28.5714V15.6098L28.2314 15.1515H21.4286V18.7771C22.0463 18.3054 22.7985 18.0509 23.5714 18.0519V18.0519ZM23.5714 19.5022C23.0031 19.5022 22.4581 19.7314 22.0562 20.1393C21.6543 20.5473 21.4286 21.1006 21.4286 21.6775C21.4286 22.2544 21.6543 22.8077 22.0562 23.2157C22.4581 23.6236 23.0031 23.8528 23.5714 23.8528C24.1398 23.8528 24.6848 23.6236 25.0867 23.2157C25.4885 22.8077 25.7143 22.2544 25.7143 21.6775C25.7143 21.1006 25.4885 20.5473 25.0867 20.1393C24.6848 19.7314 24.1398 19.5022 23.5714 19.5022ZM21.4286 10.8009V13.7013H27.1557L25 10.8009H21.4286Z',
  configuration:
    'M27.5397 19.7323L24.7205 17.6971C25.1939 15.9297 25.1913 14.0657 24.7127 12.2998L27.5413 10.2898L25.2831 6.32343L22.1375 7.78438C20.866 6.48439 19.2741 5.55484 17.5278 5.09282L17.2279 1.60137H12.7115L12.4116 5.09282C10.6657 5.55547 9.07425 6.48558 7.80349 7.78596L4.65633 6.32501L2.39969 10.2913L5.22826 12.3013C4.74945 14.0667 4.74623 15.9301 5.21893 17.6971L2.39969 19.7323L4.65633 23.6797L7.80349 22.2172C9.07444 23.517 10.6659 24.4466 12.4116 24.9088L12.7115 28.4002H17.2279L17.5278 24.9088C19.2735 24.4465 20.8649 23.5169 22.1359 22.2172L25.2831 23.6797L27.5413 19.7339L27.5397 19.7323ZM18.0858 4.42519e-07C18.2858 -0.000214523 18.4782 0.077897 18.623 0.218076C18.7677 0.358255 18.8536 0.549701 18.8629 0.752564L19.1395 3.96319C20.2884 4.40764 21.3602 5.03501 22.3146 5.82172L25.1898 4.46016C25.3674 4.36741 25.5733 4.34762 25.7649 4.40491C25.9565 4.46219 26.119 4.59215 26.2187 4.76782L29.3347 10.2424C29.4349 10.4179 29.4646 10.6258 29.4177 10.8229C29.3708 11.0201 29.2509 11.1913 29.083 11.3011L26.4813 13.1501C26.6802 14.4091 26.674 15.6634 26.4829 16.8719L29.083 18.7179C29.2513 18.8277 29.3715 18.9992 29.4184 19.1967C29.4653 19.3942 29.4353 19.6024 29.3347 19.7781L26.2187 25.2322C26.119 25.4079 25.9565 25.5378 25.7649 25.5951C25.5733 25.6524 25.3674 25.6326 25.1898 25.5398L22.3146 24.1783C21.379 24.9514 20.3129 25.5824 19.1395 26.0384L18.8629 29.249C18.8533 29.4516 18.7672 29.6427 18.6225 29.7825C18.4778 29.9223 18.2856 30.0002 18.0858 30H11.8536C11.6538 30.0002 11.4616 29.9223 11.3169 29.7825C11.1722 29.6427 11.0861 29.4516 11.0765 29.249L10.7999 26.0384C9.65097 25.5934 8.57917 24.9655 7.62476 24.1783L4.74958 25.5398C4.57202 25.6332 4.36585 25.6535 4.17393 25.5965C3.98202 25.5395 3.81914 25.4096 3.71917 25.2338L0.604647 19.7765C0.504525 19.601 0.474822 19.3931 0.521705 19.196C0.568588 18.9989 0.688454 18.8276 0.85642 18.7179L3.45652 16.8704C3.26181 15.6376 3.26181 14.3813 3.45652 13.1486L0.857974 11.3011C0.69042 11.1913 0.57084 11.0204 0.523976 10.8236C0.477112 10.6269 0.50655 10.4194 0.606201 10.244L3.71762 4.76782C3.81733 4.59174 3.9801 4.46149 4.17203 4.40419C4.36397 4.34688 4.57028 4.36693 4.74802 4.46016L7.62321 5.82172C8.57767 5.03501 9.64948 4.40764 10.7983 3.96319L11.075 0.752564C11.0842 0.549701 11.1701 0.358255 11.3148 0.218076C11.4596 0.077897 11.652 -0.000214523 11.8521 4.42519e-07H18.0842H18.0858ZM14.9697 9.48988C16.4123 9.48988 17.7959 10.0717 18.816 11.1072C19.8361 12.1428 20.4092 13.5473 20.4092 15.0118C20.4092 16.4763 19.8361 17.8809 18.816 18.9164C17.7959 19.952 16.4123 20.5338 14.9697 20.5338C13.527 20.5338 12.1435 19.952 11.1234 18.9164C10.1032 17.8809 9.53016 16.4763 9.53016 15.0118C9.53016 13.5473 10.1032 12.1428 11.1234 11.1072C12.1435 10.0717 13.527 9.48988 14.9697 9.48988ZM14.9697 11.0676C13.9392 11.0676 12.951 11.4831 12.2223 12.2228C11.4937 12.9625 11.0843 13.9658 11.0843 15.0118C11.0843 16.0579 11.4937 17.0611 12.2223 17.8008C12.951 18.5405 13.9392 18.9561 14.9697 18.9561C16.0002 18.9561 16.9884 18.5405 17.7171 17.8008C18.4457 17.0611 18.8551 16.0579 18.8551 15.0118C18.8551 13.9658 18.4457 12.9625 17.7171 12.2228C16.9884 11.4831 16.0002 11.0676 14.9697 11.0676Z',
  firmware:
    'M22.343 22.6739H7.20928V7.32609H22.343V22.6739ZM21.343 21.6739V8.32609H8.20928V21.6739H21.343ZM25.9825 5.21739C25.9825 4.31545 25.2648 3.6087 24.4127 3.6087H5.13952C4.28742 3.6087 3.56976 4.31545 3.56976 5.21739V24.7826C3.56976 25.6846 4.28742 26.3913 5.13952 26.3913H24.4127C25.2648 26.3913 25.9825 25.6846 25.9825 24.7826V5.21739ZM12.8488 1.30435H11.5639V0H12.8488V1.30435ZM24.4127 2.6087C25.8312 2.6087 26.9825 3.77739 26.9825 5.21739V24.7826C26.9825 26.2226 25.8312 27.3913 24.4127 27.3913H5.13952C3.72101 27.3913 2.56976 26.2226 2.56976 24.7826V5.21739C2.56976 3.77739 3.72101 2.6087 5.13952 2.6087H24.4127ZM12.8488 28.6957H11.5639V30H12.8488V28.6957ZM15.4186 30H14.1337V28.6957H15.4186V30ZM10.279 28.6957H8.99416V30H10.279V28.6957ZM17.9883 30H16.7034V28.6957H17.9883V30ZM20.5581 28.6957H19.2732V30H20.5581V28.6957ZM15.4186 0H14.1337V1.30435H15.4186V0ZM10.279 1.30435H8.99416V0H10.279V1.30435ZM17.9883 0H16.7034V1.30435H17.9883V0ZM20.5581 1.30435H19.2732V0H20.5581V1.30435ZM28.2674 16.9565V18.2609H29.5522V16.9565H28.2674ZM29.5522 11.7391V13.0435H28.2674V11.7391H29.5522ZM28.2674 9.13043V10.4348H29.5522V9.13043H28.2674ZM29.5522 14.3478V15.6522H28.2674V14.3478H29.5522ZM28.2674 19.5652V20.8696H29.5522V19.5652H28.2674ZM1.28488 16.9565V18.2609H0V16.9565H1.28488ZM0 11.7391V13.0435H1.28488V11.7391H0ZM1.28488 9.13043V10.4348H0V9.13043H1.28488ZM0 14.3478V15.6522H1.28488V14.3478H0ZM1.28488 19.5652V20.8696H0V19.5652H1.28488Z',
  bootloader:
    'M5.94979 23.1862C6.28555 22.3931 6.91567 21.3841 8.00123 20.236C8.00294 20.2342 8.00466 20.2323 8.00638 20.2305C8.09365 20.1383 8.18386 20.0452 8.27709 19.9513L7.6491 19.3C7.64228 19.3026 7.63547 19.3052 7.62866 19.3079C7.5607 19.3342 7.49332 19.3617 7.42652 19.3903C4.74502 20.5379 3.0056 23.4569 2.56448 26.4961C2.51583 26.8313 2.48297 27.1679 2.46638 27.5037C2.80443 27.486 3.14079 27.4524 3.47371 27.4035C6.54456 26.9524 9.32351 25.1968 10.4483 22.5501C10.483 22.4684 10.5162 22.3859 10.5477 22.3025L9.92586 21.6575C9.82554 21.7601 9.72589 21.859 9.62698 21.9544C9.61814 21.9629 9.60931 21.9714 9.60048 21.9798C9.50818 22.0684 9.41654 22.1538 9.32562 22.2362C8.34499 23.125 7.44891 23.6638 6.72685 23.9657C6.29495 24.1463 5.92532 24.2422 5.63709 24.2775C5.67132 23.9861 5.76687 23.6182 5.94979 23.1862ZM7.4682 24.7285C6.39518 25.5447 5.05253 26.1179 3.5959 26.3718C3.83352 24.9921 4.36024 23.6805 5.11407 22.6029C4.84346 23.1931 4.6959 23.7183 4.64392 24.1608L4.49542 25.4249L5.75875 25.2701C6.23202 25.2121 6.81375 25.0432 7.4682 24.7285ZM1.81969 13.1863C1.19322 13.4141 0.587602 13.7639 0 14.215C0.341351 13.5486 0.745671 12.927 1.19716 12.3559C1.46553 12.0165 1.75057 11.6949 2.04895 11.3925C3.7642 9.65229 5.9567 8.56532 7.89594 8.23333C8.32892 8.15921 8.74928 8.12272 9.14888 8.125C8.9255 8.46644 8.71125 8.81099 8.50596 9.15784C7.80377 10.3443 7.20641 11.5576 6.70697 12.7658C6.57733 13.0794 6.45429 13.3927 6.33772 13.705C6.03164 13.5306 5.73029 13.3856 5.43346 13.2684C4.14979 12.7614 2.95076 12.7749 1.81969 13.1863ZM5.80152 12.3386C6.20666 11.3631 6.67382 10.3839 7.20665 9.41669C5.78049 9.82657 4.2394 10.6648 2.94838 11.9093C3.88616 11.8181 4.83879 11.9583 5.80152 12.3386ZM17.4009 28.7772C16.835 29.2395 16.2189 29.6529 15.5568 30C15.9981 29.4083 16.3401 28.7978 16.5631 28.1661C16.9713 27.01 16.9814 25.7828 16.4742 24.4692C16.3592 24.1715 16.2176 23.8693 16.0481 23.5625C16.3494 23.443 16.6593 23.3144 16.9764 23.1762C18.0884 22.6915 19.2889 22.0886 20.5185 21.3447C20.8596 21.1383 21.203 20.9211 21.5473 20.6925C21.5513 21.0922 21.5182 21.5127 21.4492 21.9458C21.1338 23.9252 20.0664 26.1704 18.3409 27.92C18.0452 28.2201 17.7316 28.507 17.4009 28.7772ZM20.277 22.6447C19.8831 24.1043 19.0625 25.682 17.8377 26.9997C17.9254 26.0431 17.7818 25.0695 17.3971 24.0836C18.3096 23.6851 19.2798 23.2095 20.277 22.6447ZM29.4857 0.055C28.9587 0.0175 28.4416 0 27.933 0C16.4347 0 10.1216 9.2825 8.10716 16.2612L13.5595 21.7962C20.6767 19.4775 29.5522 13.325 29.5522 1.805V1.73125C29.5498 1.185 29.5288 0.62625 29.4857 0.055ZM28.5522 1.73366C28.5511 1.49439 28.5463 1.25273 28.5375 1.00868C28.3346 1.00284 28.1331 1 27.933 1C17.3712 1 11.3558 9.29445 9.23631 15.9825L13.8323 20.6482C20.6411 18.255 28.5522 12.3909 28.5522 1.805V1.73366ZM22.1642 11C20.2371 11 18.7015 9.4193 18.7015 7.5C18.7015 5.5807 20.2371 4 22.1642 4C24.0912 4 25.6269 5.5807 25.6269 7.5C25.6269 9.4193 24.0912 11 22.1642 11ZM19.7015 7.5C19.7015 8.88125 20.8035 10 22.1642 10C23.5248 10 24.6269 8.88125 24.6269 7.5C24.6269 6.11875 23.5248 5 22.1642 5C20.8035 5 19.7015 6.11875 19.7015 7.5Z',
  operating_system:
    'M15.4143 13.4128V2.41066L30 0V13.4128H15.4143ZM29.0255 12.4383V1.14883L16.3888 3.23735V12.4383H29.0255ZM30 29.2364V15.8311H15.4143V26.8676L30 29.2364ZM16.3888 26.0385L29.0255 28.0908V16.8057H16.3888V26.0385ZM12.3291 13.409H0V4.84797L12.3291 2.81053V13.409ZM11.3546 3.95934L0.974545 5.67469V12.4345H11.3546V3.95934ZM12.3291 26.4715V15.8311H0V24.4684L12.3291 26.4715ZM0.974545 23.6394L11.3546 25.3259V16.8057H0.974545V23.6394Z',
  endpoint_protection:
    'M14.9224 1.57767L25.4423 6.59262V13.7306C25.4423 20.5795 20.9314 26.9045 14.9224 28.5277C8.91353 26.9059 4.40264 20.5795 4.40264 13.732V6.59405L14.9224 1.57767ZM14.9224 30C21.7926 28.2529 26.8449 21.2787 26.8449 13.732V5.69557L14.9224 0L3 5.69557V13.732C3 21.2787 8.05231 28.2529 14.9224 30Z',
};

export const ISSUE_STATUS_STEPS: Record<IssuesV1.Common['aspect'], string> = {
  'supply-chain': VERDICT_STATUS_STEPS['supply_chain'],
  configuration: VERDICT_STATUS_STEPS['configuration'],
  firmware: VERDICT_STATUS_STEPS['firmware'],
  bootloader: VERDICT_STATUS_STEPS['bootloader'],
  'operating-system': VERDICT_STATUS_STEPS['operating_system'],
  'endpoint-protection': VERDICT_STATUS_STEPS['endpoint_protection'],
};

interface ITrustChainIcon {
  trusted: boolean;
  unsupported: boolean;
  trustedUntilThisStep: boolean;
  icon: keyof typeof VERDICT_STATUS_STEPS;
}

const colors = {
  trusted: tailwindConfig.theme.extend.colors['green-light-notification'],
  vulnerable: tailwindConfig.theme.extend.colors['red-cta'],
  unknown: tailwindConfig.theme.extend.colors['slight-red'],
};

export default function TrustChainIcon({
  trusted,
  trustedUntilThisStep,
  icon,
  unsupported,
}: ITrustChainIcon): JSX.Element {
  const iconColor = !trustedUntilThisStep && !unsupported ? colors.vulnerable : '#ffffff';

  return (
    <div
      className={classNames(
        'flex justify-center justify-self-center items-center z-10 row-start-1 w-28 h-20 boot-status-hexagon',
        {
          'text-white bg-gray-200': unsupported,
          'text-green-dark bg-green-light-notification':
            trustedUntilThisStep && trusted && !unsupported,
          'text-purple-500 bg-slight-red': !trustedUntilThisStep && !unsupported,
          'text-red-cta bg-red-cta': trustedUntilThisStep && !trusted && !unsupported,
        },
      )}>
      <svg
        width="30"
        height="30"
        viewBox="0 0 30 30"
        fill="none"
        xmlns="http://www.w3.org/2000/svg">
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d={VERDICT_STATUS_STEPS[icon]}
          fill={iconColor}
        />
      </svg>
    </div>
  );
}
